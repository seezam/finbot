# Настройка PostgreSQL на Railway

## Шаги для настройки PostgreSQL:

### 1. Создайте PostgreSQL базу данных на Railway

1. Откройте ваш проект на Railway
2. Нажмите **"+ New"** → **"Database"** → **"Add PostgreSQL"**
3. Railway автоматически создаст PostgreSQL базу данных
4. Railway автоматически добавит переменную окружения `DATABASE_URL`

### 2. Проверьте переменную окружения

1. Откройте ваш сервис (service) с ботом
2. Перейдите в **Settings → Variables**
3. Убедитесь, что есть переменная `DATABASE_URL`
4. Она должна выглядеть примерно так: `postgresql://user:password@host:port/database`

### 3. Деплой

После добавления PostgreSQL и переменной `DATABASE_URL`:
- Railway автоматически перезапустит ваш сервис
- При первом запуске бот автоматически создаст таблицы в БД
- Данные будут сохраняться в PostgreSQL

## Что происходит при первом запуске:

1. Бот подключается к PostgreSQL используя `DATABASE_URL`
2. Автоматически создаются таблицы:
   - `accounts` - счета пользователя
   - `transactions` - транзакции
   - `sessions` - сессии пользователей
3. Все данные сохраняются в БД и не теряются при перезапуске

## Проверка работы:

После деплоя проверьте логи на Railway:
- Должна быть строка: `[DB] База данных инициализирована`
- Должна быть строка: `[DB] Подключение к базе данных установлено`

## Миграция данных (если были данные в файле):

Если у вас были данные в `data.json`, их нужно будет вручную перенести в PostgreSQL или начать заново.

## Важно:

- ✅ PostgreSQL создается автоматически на Railway
- ✅ Переменная `DATABASE_URL` добавляется автоматически
- ✅ Таблицы создаются автоматически при первом запуске
- ✅ Данные сохраняются надежно и не теряются

